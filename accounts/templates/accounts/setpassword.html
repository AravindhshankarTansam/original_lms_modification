{% load static %}
<link href="{% static 'css/set_password.css' %}" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">

<div class="bg-white p-8 rounded shadow-md w-96 mx-auto mt-24">
    <h2 class="text-xl font-bold mb-4">Set Password</h2>

    {% if form.errors %}
      <div class="form-error mb-4">
        <ul>
          {% for field, error_list in form.errors.items %}
            {% for error in error_list %}
              <li>{{ error }}</li>
            {% endfor %}
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    {% if messages %}
        <div class="mb-4">
            {% for message in messages %}
                <p class="text-red-600">{{ message }}</p>
            {% endfor %}
        </div>
    {% endif %}

    {% if form.non_field_errors %}
        <div class="mb-4 text-red-600">
            <ul class="form-error">
                {% for error in form.non_field_errors %}
                    <li>{{ error }}</li>
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <form method="POST">
        {% csrf_token %}

        <!-- Password 1 -->
        <div class="form-group">
            {{ form.new_password1.label_tag }}
            <div class="password-input">
                {{ form.new_password1 }}
                <span class="toggle-password" data-target="id_new_password1">
                    <i class="fa-solid fa-eye"></i>
                </span>
            </div>
            {% if form.new_password1.errors %}
                <ul class="form-error">
                    {% for error in form.new_password1.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}

            <!-- Live password rules -->
            <div class="password-rules">
                <p>Password must contain:</p>
                <ul>
                    <li id="rule-length">At least 8 characters</li>
                    <li id="rule-uppercase">An uppercase letter</li>
                    <li id="rule-lowercase">A lowercase letter</li>
                    <li id="rule-number">A number</li>
                    <li id="rule-special">A special character (!@#$%^&*)</li>
                </ul>
            </div>
        </div>

        <!-- Password 2 -->
        <div class="form-group">
            {{ form.new_password2.label_tag }}
            <div class="password-input">
                {{ form.new_password2 }}
                <span class="toggle-password" data-target="id_new_password2">
                    <i class="fa-solid fa-eye"></i>
                </span>
            </div>
            {% if form.new_password2.errors %}
                <ul class="form-error">
                    {% for error in form.new_password2.errors %}
                        <li>{{ error }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>

        <button type="submit" class="w-full p-2 rounded mt-2">
            Save Password
        </button>
    </form>
</div>

<script src="{% static 'js/set_password.js' %}"></script>
