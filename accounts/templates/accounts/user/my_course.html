{% extends "accounts/user/base.html" %}
{% load static %}

{% block title %}My Learning | {{ request.user.username }}{% endblock %}

{% block extra_css %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="{% static 'css/my_course.css' %}">
{% endblock %}

{% block content %}
<div class="my-learning-page">
  <h1 class="page-title">My learning</h1>

  <!-- Navigation Tabs -->
  <div class="nav-tabs">
    <a href="#" class="active">All courses</a>
    <a href="#">My Lists</a>
    <a href="#">Wishlist</a>
    <a href="#">Certifications</a>
  </div>

  <!-- Filter Bar -->
  <div class="filter-bar">
    <div class="filter-left">
      <div class="filter-group">
        <label>Sort by</label>
        <select id="sortBy">
          <option selected>Recently Accessed</option>
          <option>Newest</option>
          <option>Oldest</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Categories</label>
        <select id="categories">
          <option selected>All</option>
          <option>CSC</option>
          <option>IOT</option>
          <option>AI</option>
          <option>Python</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Progress</label>
        <select id="progress">
          <option selected>All</option>
          <option>Not Started</option>
          <option>In Progress</option>
          <option>Completed</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Institute</label>
        <select id="institute">
          <option selected>All</option>
          <option>Crunch Coding Institute</option>
          <option>Smart Tech Academy</option>
        </select>
      </div>

      <button type="button" id="resetFilters">Reset</button>
    </div>

    <div class="filter-right">
      <input type="text" placeholder="Search my courses" class="search-input">
      <button class="search-btn"><i class="bi bi-search"></i></button>
    </div>
  </div>

  <!-- Courses Grid -->
  {% if courses %}
  <div class="courses-grid">
    {% for course in courses %}
    <div class="course-card">
      <div class="thumb-wrapper">
        {% if course.image %}
        <img src="{{ course.image.url }}" alt="{{ course.title }}" class="course-thumb">
        {% else %}
        <img src="{% static 'images/default_course.png' %}" alt="Default Course" class="course-thumb">
        {% endif %}
      </div>

      <div class="course-info">
        <h3 class="course-title">{{ course.title }}</h3>
        <p class="course-desc">{{ course.short_description|truncatewords:12 }}</p>
        <span class="instructor">By {{ course.instructor|default:"Unknown" }}</span>

        <div class="progress-wrapper">
          <div class="progress-bar">
            <div class="progress" style="--width: {{ course.progress|default:0 }}%">
              <div class="progress-inner"></div>
            </div>
            <span class="progress-text">{{ course.progress|default:0 }}% Complete</span>
          </div>

          <button class="start-btn">
            <a href="{% url 'course_play' course.id %}">Start Course</a>
          </button>
        </div>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <div class="no-courses">
    <img src="{% static 'images/course1.png' %}" alt="No courses">
    <h3>No courses enrolled yet</h3>
    <p>Explore our catalog and start learning new skills today.</p>
    <a href="{% url 'courses_catalog' %}" class="btn btn-primary">Explore Courses</a>
  </div>
  {% endif %}
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'js/my_course.js' %}"></script>
{% endblock %}
